# This is appended to the base image name to form the test image name
name = "t"
provision_file = "provision-test.toml"

[[vms]]
base_image = "alma-9-drbd-k70"
vcpus = 2
memory = "1G"
# No RDMA support. rdma_rxe module not available
vm_tags = [ "discard-stat", "net-ns" ]

[vms.values]
RepositoryURL = "https://nexus.at.linbit.com/repository/rhel9/"

[vms.metadata]
BuildDistribution = "rhel9.0"
BuildKernel = "5.14.0-70.13.1.el9_0" # kernel from RHEL9-rc1 for now, change when final is released
KernelRelease = "5.14.0-70.13.1.el9_0"
SourceImage = "alma-9"
KernelRepositoryURL = "https://nexus.at.linbit.com/repository/rhel-kernels/rhel9/"


[[vms]]
base_image = "alma-8-drbd-k348"
vcpus = 2
memory = "1G"
# No RDMA support. rdma_rxe module prints:
# Warning: Soft-RoCE Transport Driver - This driver has not undergone sufficient testing by Red Hat for this release and therefore cannot be used in production systems.
vm_tags = [ "discard-stat", "net-ns" ]

[vms.values]
RepositoryURL = "https://nexus.at.linbit.com/repository/rhel8/"

[vms.metadata]
BuildDistribution = "rhel8.5"
BuildKernel = "4.18.0-348.el8"
KernelRelease = "4.18.0-348.2.1.el8_5"
SourceImage = "alma-8"
KernelRepositoryURL = "https://nexus.at.linbit.com/repository/rhel-kernels/rhel8/"


[[vms]]
base_image = "alma-8-drbd-k305"
vcpus = 2
memory = "1G"
# No RDMA support. Connection frequently fails with "repost of tx_desc failed! -104".
vm_tags = [ "discard-stat", "net-ns" ]

[vms.values]
RepositoryURL = "https://nexus.at.linbit.com/repository/rhel8/"

[vms.metadata]
BuildDistribution = "rhel8.4"
BuildKernel = "4.18.0-305.el8"
KernelRelease = "4.18.0-305.25.1.el8_4"
SourceImage = "alma-8"
KernelRepositoryURL = "https://nexus.at.linbit.com/repository/rhel-kernels/rhel8/"


[[vms]]
base_image = "alma-8-drbd-k147"
vcpus = 2
memory = "1G"
vm_tags = [ "discard-stat", "rdma", "net-ns" ]

[vms.values]
RepositoryURL = "https://nexus.at.linbit.com/repository/rhel8/"

[vms.metadata]
BuildDistribution = "rhel8.1"
BuildKernel = "4.18.0-147.el8"
KernelRelease = "4.18.0-147.8.1.el8_1"
SourceImage = "alma-8"
KernelRepositoryURL = "https://nexus.at.linbit.com/repository/rhel-kernels/rhel8/"


[[vms]]
base_image = "centos-7-drbd-k1160"
vcpus = 2
memory = "1G"
vm_tags = [ "rdma" ]

[vms.values]
RepositoryURL = "https://nexus.at.linbit.com/repository/rhel7/"

[vms.metadata]
BuildDistribution = "rhel7.9"
BuildKernel = "3.10.0-1160.el7"
KernelRelease = "3.10.0-1160.49.1.el7"
SourceImage = "centos-7"
KernelRepositoryURL = "https://nexus.at.linbit.com/repository/rhel-kernels/rhel7/"


[[vms]]
base_image = "centos-7-drbd-k862"
vcpus = 2
memory = "1G"
vm_tags = [ "rdma" ]

[vms.values]
RepositoryURL = "https://nexus.at.linbit.com/repository/rhel7/"

[vms.metadata]
BuildDistribution = "rhel7.5"
BuildKernel = "3.10.0-862.el7"
KernelRelease = "3.10.0-862.14.4.el7"
SourceImage = "centos-7"
KernelRepositoryURL = "https://nexus.at.linbit.com/repository/rhel-kernels/rhel7/"


[[vms]]
base_image = "ubuntu-bionic-drbd-k188"
vcpus = 2
memory = "1G"
# No RDMA support. rdma_rxe module not installed.
vm_tags = [ "zfs" ]

[vms.values]
RepositoryURL = "https://nexus.at.linbit.com/repository/ubuntu-bionic/"
RepositoryDistribution = "bionic"

[vms.metadata]
BuildDistribution = "ubuntu-bionic"
BuildKernel = "4.15.0-188"
KernelRelease = "4.15.0-188"
SourceImage = "ubuntu-bionic"


[[vms]]
base_image = "ubuntu-focal-drbd-k121"
vcpus = 2
memory = "1G"
# No RDMA support. rdma_rxe module not installed.
vm_tags = [ "discard-stat", "zfs", "net-ns" ]

[vms.values]
RepositoryURL = "https://nexus.at.linbit.com/repository/ubuntu-focal/"
RepositoryDistribution = "focal"

[vms.metadata]
BuildDistribution = "ubuntu-focal"
BuildKernel = "5.4.0-121"
KernelRelease = "5.4.0-121"
SourceImage = "ubuntu-focal"


[[vms]]
base_image = "ubuntu-jammy-drbd-k25"
vcpus = 2
memory = "1G"
# No RDMA support. rdma_rxe module not installed.
vm_tags = [ "discard-stat", "zfs", "net-ns" ]

[vms.values]
RepositoryURL = "https://nexus.at.linbit.com/repository/ubuntu-jammy/"
RepositoryDistribution = "jammy"

[vms.metadata]
BuildDistribution = "ubuntu-jammy"
BuildKernel = "5.15.0-25"
KernelRelease = "5.15.0-25"
SourceImage = "ubuntu-jammy"
